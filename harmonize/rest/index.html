<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]-->
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <title>Harmonize Using the REST API - Data Hub Framework 4</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/marklogic-data-hub/favicon.ico">
    <meta name="application-name" content="Data Hub Framework 4 - A data hub framework for MarkLogic">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-6638631-15', 'auto');
      ga('send', 'pageview');

    </script>

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1879746318909687'); // Insert your pixel ID here.
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1879746318909687&ev=PageView&noscript=1"
    /></noscript>
    <!-- DO NOT MODIFY -->
    <!-- End Facebook Pixel Code -->
    <link type="text/css" rel="stylesheet" href="/marklogic-data-hub/assets/bundle.css">
</head>
<body class="">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/marklogic-data-hub">
                  <span class="logo">
                    <img src="/marklogic-data-hub/images/logo-marklogic.svg" width="150px" height="36px" alt="MarkLogic" title="MarkLogic" scale="0">
                  </span>
                  <span class="global-title">Data Hub Framework 4</span>
                </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                        <li  >
                            
                            <a href="https://docs.marklogic.com/datahub/">NEW! Data Hub 5.0 docs</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="/marklogic-data-hub/docs/">DHF 4.x docs</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="https://github.com/marklogic/marklogic-data-hub/releases/">Download</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="/marklogic-data-hub/learndhf/">Learn</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="/marklogic-data-hub/contact/">Contact</a>
                            
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>




  <!-- <div class="bannered-image">
  <picture>
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-xs.jpg" media="(max-width: 400px)">
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-sm.jpg" media="(max-width: 800px)">
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-lg.jpg" media="(min-width: 801px)">
    <img srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-lg.jpg" alt="Operational Data Hub" scale="0">
  </picture>
  <div class="banner banner-light banner-center text-center">
    <div class="center-container">
      <div class="centered-text">
        <div class="col-sm-12 text-right text-center">
          <img alt="dhf icon" src="/marklogic-data-hub/images/odh.svg" scale="0" class="icon-left">
          <h3>
          
            Harmonize Using the REST API
          
          </h3>
        </div>
      </div>
    </div>
  </div>
</div>
 -->

  <article>
    <div class="container">
      <div class="row">
        <div class="side-nav col-md-2 hide-small">
          <div class="panel panel-default">
  <!-- <div class="panel-heading">Navigation</div> -->
  <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/">Data Hub Framework 4.x</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="http://docs.marklogic.com/datahub/">NEW! Data Hub 5.0 docs</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/release-notes/">Release Notes</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://github.com/marklogic/marklogic-data-hub/releases/">Download</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/upgrade/">Upgrade</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/learndhf/">Learning DHF</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/tutorial/">QuickStart Tutorial</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://mlu.marklogic.com/ondemand/index.xqy?q=Concept%3A%22data%20hub%20framework%22">MarkLogic University</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/">Understanding DHF</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/concepts/">DHF as an Operational Data Hub</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/entities/">Entities</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/flows/">Flows</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/plugins/">Plugins</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/envelope-pattern/">Envelope Pattern</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/tools/">DHF Tools</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/tools/quickstart/">DHF QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/tools/gradle-plugin/">DHF Gradle Plugin</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/javadocs/">DHF Java Library</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/guide/mlcp/">MarkLogic Content Pump</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/REST/client/">REST Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/javadoc/client/">Java Client API</a>
    
    
  </li>
  
</ul>

    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/using/">Using DHF</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/">Create Project</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/quickstart/">Using QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/gradle/">Using Gradle</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/flow-tracing/">Configure Flow Tracing</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/">Ingest</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/quickstart/">Using QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/mlcp/">Using MLCP</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/rest/">Using the REST Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/marklogic-client-api/">Using the Java Client API</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/">Harmonize</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/quickstart/">Using QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/gradle/">Using Gradle</a>
    
    
  </li>
  
  <li  class="list-group-item active"  >
    
    <a href="/marklogic-data-hub/harmonize/rest/">Using the REST Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/java/">Using the Java Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/mapping/">Using Model-to-Model Mapping</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/deploy/">Deploy</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/deploy/deploy-to-dhs/">Deploy to DHS</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/serve/">Serve</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/REST/client">Using the REST Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/guide/admin/odbc">Using ODBC</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://docs.marklogic.com/guide/java/DataServices">Using Java</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/govern/pii/">Protect PII</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/">References</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/javadocs/">DHF API Library</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/servers-databases/">Servers and Databases</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/project-structure/">Project Directory Structure</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/rest-extensions/">REST Extensions</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/gradle-properties/">DHF Gradle Properties</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/gradle-tasks/">DHF Gradle Tasks</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/server-side-library/">Server Side API Library</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/security/">Security</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/index-settings/">Index Settings</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/version-compatibility/">Version Compatibility</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/faqs/">FAQs</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/refs/glossary/">DHF Glossary</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://github.com/marklogic/marklogic-data-hub">DHF on GitHub</a>
    
    
  </li>
  
</ul>

</div>

        </div>
        <div class="col-md-10">
          <h1 id="harmonize-using-the-rest-api">Harmonize Using the REST API</h1>

<p>When the DHF library runs a flow, it first calls the collector to get the list of strings to operate on. Then it splits the strings into batches and calls a custom REST extension that invokes the main.(xqy|sjs) for your flow.</p>

<p>If you already know the specific ID or URI of a specific item to pass to the flow, you can skip the collector phase and go to the harmonize phase by invoking one of the two REST Client API “flow” extensions that is installed when you set up DHF.</p>
<ul>
  <li>To use an XQuery extension, send a POST HTTP request to /LATEST/resources/ml:flow.</li>
  <li>If your extension is implemented in JavaScript, use the <code class="highlighter-rouge">ml:sjsFlow</code> extension.</li>
</ul>

<h2 id="using-http">Using HTTP</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /v1/resources/ml:flow?rs:identifiers=someIdentifier&amp;rs:entity-name=EntityName&amp;rs:flow-name=FlowName&amp;rs:target-database=Documents&amp;rs:options={"some":"json"}&amp;rs:job-id=SomeJobID

POST /v1/resources/ml:sjsFlow?rs:identifiers=someIdentifier&amp;rs:entity-name=EntityName&amp;rs:flow-name=FlowName&amp;rs:target-database=Documents&amp;rs:options={"some":"json"}&amp;rs:job-id=SomeJobID
</code></pre></div></div>

<p>The parameters are the following:</p>

<ul>
  <li><strong>rs:identifiers</strong> - the identifier of the document(s) to operate on. Pass this parameter multiple times for multiple identifiers.</li>
  <li><strong>rs:entity-name</strong> - the name of the entity to which the flow belongs.</li>
  <li><strong>rs:flow-name</strong> - the name of the flow.</li>
  <li><strong>rs:target-database</strong> - the name of the target database.</li>
  <li><strong>rs:options</strong> -  additional JSON options you can pass to the flow. Must be a JSON object.</li>
  <li><strong>rs:job-id</strong> - a job id, any string is OK.</li>
</ul>

<h2 id="using-the-java-client-api">Using the Java Client API</h2>

<p><strong>FlowResource.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">FlowResource</span> <span class="kd">extends</span> <span class="n">ResourceManager</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="kd">final</span> <span class="kd">public</span> <span class="n">String</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s">"flow"</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">DatabaseClient</span> <span class="n">srcClient</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">targetDatabase</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Flow</span> <span class="n">flow</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">FlowResource</span><span class="o">(</span><span class="n">DatabaseClient</span> <span class="n">srcClient</span><span class="o">,</span> <span class="n">String</span> <span class="n">targetDatabase</span><span class="o">,</span> <span class="n">Flow</span> <span class="n">flow</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">flow</span> <span class="o">=</span> <span class="n">flow</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">srcClient</span> <span class="o">=</span> <span class="n">srcClient</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">targetDatabase</span> <span class="o">=</span> <span class="n">targetDatabase</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">srcClient</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">NAME</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">RunFlowResponse</span> <span class="nf">run</span><span class="o">(</span><span class="n">String</span> <span class="n">jobId</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">RunFlowResponse</span> <span class="n">resp</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">RequestParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RequestParameters</span><span class="o">();</span>
            <span class="n">params</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"entity-name"</span><span class="o">,</span> <span class="n">flow</span><span class="o">.</span><span class="na">getEntityName</span><span class="o">());</span>
            <span class="n">params</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"flow-name"</span><span class="o">,</span> <span class="n">flow</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
            <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"job-id"</span><span class="o">,</span> <span class="n">jobId</span><span class="o">);</span>
            <span class="c1">// note that the identifiers parameter is actually an array of strings</span>
            <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"identifiers"</span><span class="o">,</span> <span class="o">[</span><span class="n">item</span><span class="o">]);</span>
            <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"target-database"</span><span class="o">,</span> <span class="n">targetDatabase</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">options</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
                <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"options"</span><span class="o">,</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">options</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="n">StringHandle</span> <span class="n">handle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringHandle</span><span class="o">(</span><span class="s">"{}"</span><span class="o">).</span><span class="na">withFormat</span><span class="o">(</span><span class="n">Format</span><span class="o">.</span><span class="na">JSON</span><span class="o">);</span>
            <span class="n">ResourceServices</span><span class="o">.</span><span class="na">ServiceResultIterator</span> <span class="n">resultItr</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServices</span><span class="o">().</span><span class="na">post</span><span class="o">(</span><span class="n">params</span><span class="o">,</span> <span class="n">handle</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">resultItr</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span> <span class="n">resultItr</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RunFlowResponse</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">else</span> <span class="o">{</span>
                <span class="n">ResourceServices</span><span class="o">.</span><span class="na">ServiceResult</span> <span class="n">res</span> <span class="o">=</span> <span class="n">resultItr</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
                <span class="n">StringHandle</span> <span class="n">handle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringHandle</span><span class="o">();</span>
                <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">getContent</span><span class="o">(</span><span class="n">handle</span><span class="o">).</span><span class="na">get</span><span class="o">(),</span> <span class="n">RunFlowResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="o">}</span>

        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resp</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now run it:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.marklogic.hub.HubConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.marklogic.hub.HubConfigBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.marklogic.hub.flow.*</span><span class="o">;</span>

<span class="c1">// get a hub config</span>
<span class="n">HubConfig</span> <span class="n">dataHubConfig</span> <span class="o">=</span> <span class="n">HubConfigBuilder</span><span class="o">.</span><span class="na">newHubConfigBuilder</span><span class="o">(</span><span class="s">"/path/to/your/project"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withPropertiesFromEnvironment</span><span class="o">(</span><span class="s">"local"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="c1">// get a flow manager</span>
<span class="n">FlowManager</span> <span class="n">flowManager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowManager</span><span class="o">(</span><span class="n">dataHubConfig</span><span class="o">);</span>

<span class="c1">// retrieve the flow you wish to run</span>
<span class="n">Flow</span> <span class="n">harmonizeFlow</span> <span class="o">=</span> <span class="n">flowManager</span><span class="o">.</span><span class="na">getFlow</span><span class="o">(</span><span class="s">"my entity name"</span><span class="o">,</span> <span class="s">"my flow name"</span><span class="o">,</span> <span class="n">FlowType</span><span class="o">.</span><span class="na">HARMONIZE</span><span class="o">);</span>

<span class="c1">// create an instance of FlowResource to run.</span>
<span class="n">FlowResource</span> <span class="n">flowResource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlowResource</span><span class="o">(</span><span class="n">databaseClient</span><span class="o">,</span> <span class="s">"data-hub-FINAL"</span><span class="o">,</span> <span class="n">flow</span><span class="o">);</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">flowResource</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">jobId</span><span class="o">,</span> <span class="s">"yourIdentifier"</span><span class="o">,</span> <span class="n">options</span><span class="o">);</span>
</code></pre></div></div>

        </div>
      </div>
    </div>
  </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p>
                    Copyright © 2016-2020 MarkLogic Corporation. All Rights Reserved. MARKLOGIC® is a registered trademark of MarkLogic Corporation.
                    </p>
                </div>
            </div>
        </div>
    </footer>


    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="/marklogic-data-hub/js/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="/marklogic-data-hub/assets/bundle.js" id="1"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79716597-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>

